<!DOCTYPE html>
<html>
<head>
    <title>GWS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <!-- Add Poppins font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Apply Poppins font to the body */
        body {
            font-family: 'Poppins', sans-serif;
        }
    </style>
    <!-- Add Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase
        const supabaseUrl = 'https://xvkjvftrriznqbvszdzo.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2a2p2ZnRycml6bnFidnN6ZHpvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkyNzY4MzksImV4cCI6MjA2NDg1MjgzOX0.kRauc7Ts9NhNwdiiwwllHstLfIgJsB7Urf5obVMWbnk';
        const client = supabase.createClient(supabaseUrl, supabaseKey);
    </script>
</head>
<body class="font-poppins bg-gray-100">
    <!-- Navbar -->
    <nav class="bg-[#2E619F] text-white p-4 md:p-6 sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center">
                <img src="../Illustrations/Logo.png" alt="GWS logo" class="h-8 md:h-10 w-auto mr-2">
            </div>
            <div class="hidden md:flex space-x-6 items-center">
                <a href="journal.html" class="hover:underline hover:text-blue-200 transition">Journal</a>
                <a href="moodtracker.html" class="hover:underline hover:text-blue-200 transition">Tracker</a>
                <a href="article.html" class="hover:underline hover:text-blue-200 transition">Articles</a>
                <a href="music.html" class="hover:underline hover:text-blue-200 transition">Music</a>
                
                <!-- Avatar with Dropdown -->
                <div class="relative group flex items-center space-x-1">
                    <button id="avatar-button" class="focus:outline-none">
                        <img id="user-avatar" src="../Illustrations/Generic avatar.png" width="40" height="40" class="rounded-full cursor-pointer">
                    </button>
                    <span id="username" class="text-white font-bold">Guest</span>
                    
                    <!-- Dropdown Menu -->
                    <div id="avatar-dropdown" class="hidden absolute right-0 top-full mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 group-hover:block">
                        <a href="profile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Profile</a>
                        <a href="settings.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                        <a href="gws.html" id="logout-btn" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">Logout</a>
                    </div>
                </div>
            </div>
            <button class="md:hidden text-2xl" id="mobile-menu-button">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    
        <!-- Mobile Menu -->
        <div class="md:hidden hidden bg-[#1a4a7f] w-full" id="mobile-menu">
            <div class="container mx-auto py-4 flex flex-col space-y-4">
                <a href="journal.html" class="hover:underline hover:text-blue-200 transition">Journal</a>
                <a href="moodtracker.html" class="hover:underline hover:text-blue-200 transition">Tracker</a>
                <a href="article.html" class="hover:underline hover:text-blue-200 transition">Articles</a>
                <a href="music.html" class="hover:underline hover:text-blue-200 transition">Music</a>
                <a href="login.html" class="text-red-400 hover:underline">Log Out</a>
            </div>
        </div>
    </nav>
    
    <script>
        // Toggle dropdown on avatar click
        document.getElementById('avatar-button').addEventListener('click', function(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('avatar-dropdown');
            dropdown.classList.toggle('hidden');
        });
    
        // Close dropdown when clicking outside
        document.addEventListener('click', function() {
            const dropdown = document.getElementById('avatar-dropdown');
            dropdown.classList.add('hidden');
        });
    
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });

        // Check auth state on page load
        document.addEventListener('DOMContentLoaded', async () => {
            await checkAuthState();
            
            // Set up auth state listener
            supabase.auth.onAuthStateChange((event, session) => {
                if (event === 'SIGNED_IN' && session?.user) {
                    updateUserProfile(session.user);
                } else if (event === 'SIGNED_OUT') {
                    setGuestState();
                }
            });
            
            // Logout functionality
            document.getElementById('logout-btn')?.addEventListener('click', logoutUser);
        });

        // Check authentication state
        async function checkAuthState() {
            try {
                const { data: { user }, error } = await supabase.auth.getUser();
                
                if (user) {
                    updateUserProfile(user);
                } else {
                    setGuestState();
                }
            } catch (error) {
                console.error('Auth check failed:', error);
                setGuestState();
            }
        }

        // Update UI with user profile
        function updateUserProfile(user) {
            const usernameElement = document.getElementById('username');
            const avatarElement = document.getElementById('user-avatar');
            
            // Set username
            usernameElement.textContent = user.user_metadata?.full_name || user.email || 'User';
            
            // Set avatar (if available)
            if (user.user_metadata?.avatar_url) {
                avatarElement.src = user.user_metadata.avatar_url;
            } else if (user.identities?.[0]?.identity_data?.avatar_url) {
                avatarElement.src = user.identities[0].identity_data.avatar_url;
            }
        }

        // Set guest state
        function setGuestState() {
            document.getElementById('username').textContent = 'Guest';
            document.getElementById('user-avatar').src = '../Illustrations/Generic avatar.png';
        }

        // Logout user
        async function logoutUser() {
            try {
                const { error } = await supabase.auth.signOut();
                if (error) throw error;
                window.location.href = 'login.html';
            } catch (error) {
                console.error('Logout failed:', error);
                alert('Logout failed. Please try again.');
            }
        }
    </script>


    <!-- Journal Section -->
    <section class="bg-[#5385c3] text-white p-24">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between">
            <div class="md:w-1/2">
                <h1 class="text-4xl font-bold mb-4">Welcome to GWS!</h1>
                <p class="mb-4">A website where you can note down your thoughts in an online journal, track your moods, and help you with calmness.</p>
                <button class="bg-[#2E619F] px-6 py-3 rounded-[30px]" onclick="window.location.href='journal.html'">Begin Journaling</button>
            </div>
            <div class="md:w-1/2 flex justify-end">
                <img src="../Illustrations/sitting reading.png" alt="Sitting Reading img" class="h-30 w-30 mr-2">            </div>
        </div>
    </section>

    <!-- Mood Tracking Section -->
    <section class="bg-[#3C72B6] text-white p-24">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between">
            <div class="md:w-1/2 flex justify-start">
                <img src="../Illustrations/laying.png" alt="Laying img mood tracker" class="h-30 w-30 mr-1">            </div>
            <div class="md:w-1/2 text-right">
                <h2 class="text-3xl font-bold mb-4">Track your mood</h2>
                <p class="mb-4">Track your mood at any time of the day, your sleep condition, and hobbies.</p>
                <button class="bg-[#2E619F] px-6 py-3 rounded-[30px]">Begin Tracking</button>
            </div>
        </div>
    </section>
</section>
<section class="bg-white text-center py-16">
 <h2 class="text-3xl font-bold mb-6">
  Other Services
 </h2>
 <div class="flex justify-center space-x-8">
  <button class="bg-[#2E619F] hover:bg-blue-600 text-white p-10 rounded-lg w-300">
   <img alt="meditating" src="../Illustrations/meditating.png" class="mx-auto mb-4" height="200" width="300"/>

   <h3 class="text-xl font-bold mb-2">
    Meditation
   </h3>
   <p class="p-5">
    Calm down by meditating
   </p>
  </button>
  <button class="bg-[#2E619F] hover:bg-blue-600 text-white p-10 rounded-lg w-300">
   <img alt="dancing" src="../Illustrations/dancing2.png" class="mx-auto mb-4" height="200" width="300"/>

   <h3 class="text-xl font-bold mb-2">
    Music
   </h3>
   <p class="p-2">
    Listen to some calming music
   </p>
</button>
 </div>
</section>
<section class="bg-white text-center py-16">
 <h2 class="text-3xl font-bold mb-8">
  Recommended Articles:
 </h2>
 <div class="flex justify-center items-center space-x-4">
  <button class="bg-[#2E619F] text-white p-2 rounded-full">
   <i class="fas fa-chevron-left">
   </i>
  </button>
  <div class="flex space-x-4">
   <div class="bg-white shadow-lg rounded-lg overflow-hidden w-64">
    <img alt="Article image 1" class="w-full" height="144" src="../Illustrations/stress.jpg" width="256"/>
    <div class="p-4">
     <h3 class="text-lg font-bold mb-2">
      Ketahui Cara Mengelola Stres yang Baik
     </h3>
     <button class="bg-[#2E619F] hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
      Read More
     </button>
    </div>
   </div>
   <div class="bg-white shadow-lg rounded-lg overflow-hidden w-64">
    <img alt="Article image 2" class="w-full" height="144" src="../Illustrations/stress.jpg" width="256"/>
    <div class="p-4">
     <h3 class="text-lg font-bold mb-2">
      Ketahui Cara Mengelola Stres yang Baik
     </h3>
     <button class="bg-[#2E619F] hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
      Read More
     </button>
    </div>
   </div>
   <div class="bg-white shadow-lg rounded-lg overflow-hidden w-64">
    <img alt="Article image 3" class="w-full" height="144" src="Illustrations/stress.jpg" width="256"/>
    <div class="p-4">
     <h3 class="text-lg font-bold mb-2">
      Ketahui Cara Mengelola Stres yang Baik
     </h3>
     <button class="bg-[#2E619F] hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
      Read More
     </button>
    </div>
   </div>
  </div>
  <button class="bg-[#2E619F] text-white p-2 rounded-full">
   <i class="fas fa-chevron-right">
   </i>
  </button>
 </div>
</section>
</main>
<footer class="bg-blue-700 text-white text-center py-8">
<nav class="mb-4">
 <a class="hover:underline mx-2" href="#">
  About
 </a>
 <a class="hover:underline mx-2" href="#">
  Journal
 </a>
 <a class="hover:underline mx-2" href="#">
  Tracker
 </a>
 <a class="hover:underline mx-2" href="#">
  Article
 </a>
 <a class="hover:underline mx-2" href="#">
  Music
 </a>
</nav>
<div class="flex justify-center space-x-4 mb-4">
 <a class="hover:text-gray-400" href="#">
  <i class="fab fa-facebook-f">
  </i>
 </a>
 <a class="hover:text-gray-400" href="#">
  <i class="fab fa-instagram">
  </i>
 </a>
 <a class="hover:text-gray-400" href="#">
  <i class="fab fa-twitter">
  </i>
 </a>
 <a class="hover:text-gray-400" href="#">
  <i class="fab fa-telegram">
  </i>
 </a>
</div>
<div class="flex justify-center items-center">
 <img alt="GWS logo" class="mr-2" height="40" src="../Illustrations/Logo.png" width="40"/>
</div>
</footer>
</body>
</html>